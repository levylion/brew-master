<div class="logs-container">
    <h2 style="color: var(--primary-color); margin-bottom: 1rem;">System Logs</h2>

    <div
        style="background: rgba(59, 130, 246, 0.1); border: 1px solid #3b82f6; color: #93c5fd; padding: 1rem; border-radius: 8px; margin-bottom: 2rem;">
        <strong>System Status:</strong> Displaying {{logs.length}} records.
    </div>

    <div class="card" style="padding: 0; overflow: hidden;">
        <!-- BUG: DOM Overload -->
        <!-- Rendering 10k complex items triggers massive layout/painting cost -->
        <div class="log-list" style="height: 600px; overflow-y: auto;">
            @for (log of logs; track log.id) {
            <div class="log-item" style="
                    display: flex;
                    flex-direction: column;
                    gap: 8px; 
                    padding: 12px 16px; 
                    border-bottom: 1px solid var(--border-color);
                    font-family: monospace;
                    font-size: 0.9rem;
                    background: rgba(255, 255, 255, 0.02);
                ">
                <!-- Header Row -->
                <div style="display: flex; align-items: center; gap: 1rem;">
                    <span style="color: #666; min-width: 180px;">{{ log.timestamp }}</span>
                    <div [style.background]="getSeverityColor(log.severity)" style="
                            padding: 2px 8px; 
                            border-radius: 4px; 
                            color: #000; 
                            font-weight: bold; 
                            text-shadow: 0 0 2px rgba(0,0,0,0.2);
                        ">
                        {{ log.severity }}
                    </div>
                    <span style="color: var(--primary-color);">[{{ log.module }}]</span>
                    <span style="color: var(--text-color); flex: 1; font-weight: 500;">{{ log.message }}</span>
                </div>

                <!-- Heavy Metadata Grid -->
                <div style="
                        display: grid; 
                        grid-template-columns: repeat(3, 1fr); 
                        gap: 8px; 
                        margin-top: 4px;
                        opacity: 0.8;
                        font-size: 0.8rem;
                    ">
                    @for (meta of log.metadata; track meta.key) {
                    <div style="background: rgba(0,0,0,0.2); padding: 4px; border-radius: 4px;">
                        <span style="color: var(--text-muted);">{{meta.key}}:</span>
                        <span style="color: #fff;">{{meta.value}}</span>
                    </div>
                    }
                </div>

                <!-- Heavy Stack Trace (Nested DOM) -->
                @if (log.severity === 'ERROR' || log.severity === 'WARN') {
                <div style="
                            margin-top: 4px; 
                            background: #111; 
                            padding: 8px; 
                            border-radius: 4px;" [style.border-left]="'2px solid ' + getSeverityColor(log.severity)">
                    <div style=" color: var(--text-muted); margin-bottom: 4px;">Stack Trace:</div>
                    @for (line of log.stackTrace; track line) {
                    <div style="color: #666; padding-left: 8px;">{{line}}</div>
                    }
                </div>
                }

                <!-- Menu Button (Interaction Lag Trigger) -->
                <div style="position: absolute; top: 12px; right: 12px;">
                    <button (click)="toggleMenu(log.id)" style="
                        background: none; 
                        border: none; 
                        color: #fff; 
                        cursor: pointer; 
                        font-size: 1.2rem;
                        padding: 4px;
                    ">â‹®</button>

                    @if (activeMenuId === log.id) {
                    <div style="
                            position: absolute; 
                            right: 0; 
                            top: 100%; 
                            background: #222; 
                            border: 1px solid #444; 
                            border-radius: 4px; 
                            z-index: 10;
                            width: 150px;
                            box-shadow: 0 4px 12px rgba(0,0,0,0.5);
                        ">
                        <div style="padding: 8px 12px; border-bottom: 1px solid #333; cursor: pointer;">View Details
                        </div>
                        <div style="padding: 8px 12px; border-bottom: 1px solid #333; cursor: pointer;">Copy Log ID
                        </div>
                        <div style="padding: 8px 12px; color: #ef4444; cursor: pointer;">Delete Entry</div>
                    </div>
                    }
                </div>
            </div>
            }
        </div>
    </div>
</div>